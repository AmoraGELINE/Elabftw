/*! elabftw 1.6.0 https://www.elabftw.net */
$(document).ready(function(){$(document).on("click","#lock",function(){$.post("app/controllers/EntityController.php",{lock:!0,type:$(this).data("type"),id:$(this).data("id")}).done(function(data){var json=JSON.parse(data);json.res?(notif(json.msg,"ok"),current=$("#lock").attr("src"),"app/img/lock-gray.png"===current?$("#lock").attr("src","app/img/unlock.png"):$("#lock").attr("src","app/img/lock-gray.png")):notif(json.msg,"ko")})}),$(document).on("click",".click2Edit",function(){var page=$(this).data("page"),id=$(this).data("id");document.location=page+"?mode=edit&id="+id});var Comments={controller:"app/controllers/CommentsController.php",create:function(expId){return document.getElementById("commentsCreateButton").disabled=!0,comment=$("#commentsCreateArea").val(),comment.length<2?(notif("Comment too short!"),document.getElementById("commentsCreateButton").disabled=!1,!1):void $.post(this.controller,{commentsCreate:!0,comment:comment,id:expId}).done(function(data){var json=JSON.parse(data);json.res?(notif(json.msg,"ok"),$("#expcomment_container").load("experiments.php?mode=view&id="+expId+" #expcomment")):notif(json.msg,"ko")})},destroy:function(id,expId,confirmText){return confirm(confirmText)?void $.post(this.controller,{destroy:!0,id:id}).done(function(data){var json=JSON.parse(data);json.res?(notif(json.msg,"ok"),$("#expcomment_container").load("experiments.php?mode=view&id="+expId+" #expcomment")):notif(json.msg,"ko")}):!1}};$("#commentsCreateButtonDiv").hide(),$(document).on("focus","#commentsCreateArea",function(){$("#commentsCreateButtonDiv").show()}),$(document).on("click","#commentsCreateButton",function(){Comments.create($(this).data("expid"))}),$(document).on("mouseover",".editable",function(){expId=$(this).data("expid"),$("div#expcomment p.editable").editable(Comments.controller,{name:"commentsUpdate",tooltip:"Click to edit",indicator:$(this).data("indicator"),submit:$(this).data("submit"),cancel:$(this).data("cancel"),style:"display:inline",callback:function(){$("#expcomment_container").load("experiments.php?mode=view&id="+expId+" #expcomment")}})}),$(document).on("click",".commentsDestroy",function(){Comments.destroy($(this).data("id"),$(this).data("expid"),$(this).data("confirm"))}),$(document).on("click","#confirmTimestamp",function(){expId=$(this).data("expid"),console.log(expId),$("#confirmTimestampDiv").dialog({resizable:!1,height:"auto",width:400,modal:!0,buttons:{"Timestamp it":function(){$("#confirmTimestampDiv").text($(this).data("wait")),$.post("app/controllers/ExperimentsController.php",{timestamp:!0,id:expId}).done(function(data){var json=JSON.parse(data);json.res?window.location.replace("experiments.php?mode=view&id="+expId):notif(json.msg,"ko")})},Cancel:function(){$(this).dialog("close")}}})}),$("#confirmTimestampDiv").hide(),key($("#shortcuts").data("create"),function(){location.href=$("#shortcuts").data("controller")+"?create=true"}),key($("#shortcuts").data("edit"),function(){location.href=$("#shortcuts").data("page")+"?mode=edit&id="+$("#shortcuts").data("id")})});