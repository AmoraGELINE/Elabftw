{% set tsConfigArr = App.Request.getScriptName|split('/')|last == 'admin.php' ? teamConfigArr : App.Config.configArr %}
{% set model = App.Request.getScriptName|split('/')|last == 'admin.php' ? 'team' : 'config' %}

<!-- SELECT TIMESTAMPING EXTERNAL SERVICE -->
<label for='ts_authority'>{{ 'Select timestamping authority (TSA):'|trans }}</label>
<select class='form-control col-md-4' data-trigger='change' data-model='{{ model }}' data-target='ts_authority' id='ts_authority' autocomplete='off'>
  <option value='dfn' {{ tsConfigArr.ts_authority == 'dfn' ? ' selected' }}>{{ 'DFN (default, no account required)'|trans }}</option>
  <option value='universign' {{ tsConfigArr.ts_authority == 'universign' ? 'selected' }}>{{ 'Universign (requires account)'|trans }}</option>
  <option value='custom' {{ tsConfigArr.ts_authority == 'custom' ? 'selected' }}>{{ 'Custom TSA'|trans }}</option>
</select>

<div id='ts_loginpass' {{ tsConfigArr.ts_authority == 'dfn' ? 'hidden' : '' }}>
  <!-- STAMPLOGIN -->
  <label for='stamplogin'>{{ 'Login for external timestamping service:'|trans }}</label>
  <input class='form-control col-md-4' data-trigger='blur' data-model='{{ model }}' data-target='stamplogin' type='text' value='{{ tsConfigArr.stamplogin }}' id='stamplogin' autocomplete='off' />

  <!-- TIMESTAMP PASSWORD -->
  <label for='ts_password'>{{ 'Password for external timestamping service:'|trans }}</label>
  {% if tsConfigArr.ts_password %}
    <p>A password is already set.
    <a href='#' data-trigger='click' data-model='{{ model }}' data-target='ts_password' data-action='destroystamppass' data-reload='ts_loginpass'>Clear it</a> or change it below:</p>
  {% endif %}
  <input class='form-control col-md-4' data-trigger='blur' data-model='{{ model }}' data-target='ts_password' data-reload='ts_loginpass' autocomplete='off' maxlength='200' type='password' id='ts_password' />
</div>

<div id='ts_urlcert' {{ tsConfigArr.ts_authority != 'custom' ? 'hidden' : '' }}>
  <label for='stampprovider'>{{ 'URL for external timestamping service:'|trans }}</label>
  <input class='form-control col-md-4' data-trigger='blur' data-model='{{ model }}' data-target='stampprovider' type='url' placeholder='https://tsa.example.com' value='{{ tsConfigArr.stampprovider }}' id='stampprovider' autocomplete='off' />
  <p class='smallgray'>{{ 'This should be the URL used for %sRFC 3161%s-compliant timestamping requests.'|trans|format("<a href='https://tools.ietf.org/html/rfc3161'>", "</a>")|raw }}</p>

  <label for='stampcert'>{{ 'Chain of certificates of the external timestamping service:'|trans }}</label>
  <input class='form-control col-md-4' data-trigger='blur' data-model='{{ model }}' data-target='stampcert' type='text' placeholder='path/to/cert.pem' value='{{ tsConfigArr.stampcert }}' name='stampcert' id='stampcert' />
  <p class='smallgray'>{{ "This should point to the chain of certificates used by your external timestamping provider to sign the timestamps.%sLocal path relative to eLabFTW installation directory. You should add it in the 'uploads' folder. The file needs to be in %sPEM-encoded (ASCII)%s format!"|trans|format("<br>", "<a href='https://en.wikipedia.org/wiki/Privacy-enhanced_Electronic_Mail'>", "</a>")|raw }}</p>
</div>
